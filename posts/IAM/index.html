<!DOCTYPE html><html lang="en-US" mode="light" ><head> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="pv-cache-path" content="/true"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="AWS - IdenAccessManage - IAM (Identity and Access Management)" /><meta property="og:locale" content="en_US" /><meta name="description" content="[toc]" /><meta property="og:description" content="[toc]" /><link rel="canonical" href="https://ocholuo.github.io//posts/IAM/" /><meta property="og:url" content="https://ocholuo.github.io//posts/IAM/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-18T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AWS - IdenAccessManage - IAM (Identity and Access Management)" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"[toc]","headline":"AWS - IdenAccessManage - IAM (Identity and Access Management)","dateModified":"2021-02-20T17:56:15-05:00","url":"https://ocholuo.github.io//posts/IAM/","datePublished":"2020-07-18T11:11:11-04:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/IAM/"},"@context":"https://schema.org"}</script><title>AWS - IdenAccessManage - IAM (Identity and Access Management) | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script async src="/assets/js/dist/pvreport.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/rabbit.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2021 Jun 22 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>AWS - IdenAccessManage - IAM (Identity and Access Management)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>AWS - IdenAccessManage - IAM (Identity and Access Management)</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Jul 18, 2020, 11:11 AM -0400" prep="on" > Jul 18, 2020 <i class="unloaded">2020-07-18T11:11:11-04:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Feb 20, 2021, 5:56 PM -0500" prefix="Updated " > Feb 20 <i class="unloaded">2021-02-20T17:56:15-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2797 words">15 min</span> <span id="pv" class="pageviews"><i class="fas fa-spinner fa-spin fa-fw"></i></span></div></div><div class="post-content"><p>[toc]</p><hr /><h1 id="aws---iam-identity-and-access-management">AWS - IAM Identity and Access Management</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/ZW9dsDI.png" width="400" /></p><hr /><h2 id="-iam-best-practices-"><font color="red"> IAM BEST PRACTICES </font></h2><ul><li>Lock away the AWS root user access keys.<ul><li> <font color="red"> no access key for the root account user </font></ul><li>not use the root account for anything other than billing.<ul><li>Power user access allows all permissions except the management of groups and users in IAM.</ul><li>Create <font color="red"> individual IAM users </font><li>Use AWS defined <code class="language-plaintext highlighter-rouge">policies</code> to assign permissions whenever possible.<li> <font color="red"> Use groups to assign permissions </font><p>to IAM users.</p><li>Grant least privilege.<li>Use access levels to review IAM permissions.<li> <font color="red"> Use roles for applications </font><p>that run on AWS EC2 instances.</p><li>Delegate by using roles instead of sharing credentials.<li>Configure a strong password policy for users.<li> <font color="red"> Enable MFA for all users </font><li>Rotate credentials regularly.<li>Remove unnecessary credentials.<li>Use policy conditions for extra security.<li>Monitor activity in your AWS account.<li>Use <font color="red"> Temporary Security Credentials (IAM Roles) </font> Instead of Long-Term Access Keys.<li>Manage IAM User Access Keys Properly.</ul><hr /><h2 id="basics">basics</h2><blockquote><p>颗粒状的 Granular permissions</p></blockquote><ul><li><p>a tool that centrally manages access to <font color="red"> launching, configuring, managing, and terminating resources in the AWS account </font></p><li>grant different permissions to different people for different resources. <ul><li><strong>who, which, how</strong></ul><li>feature of the AWS account, no additional charge.</ul><blockquote><p>IAM has the following features to control access:</p></blockquote><ul><li><strong>provides Granular permissions</strong> over access to resources, IAM can be used to manage:<ul><li>provides <font color="red"> 颗粒状的 Granular permissions </font><ul><li>grant different permissions to different people / resources.</ul><li>Users. Groups. Access policies. Roles.<li>User credentials. User password policies.<li>for AWS Management Console, AWS CLI, or AWS software development kits (SDKs),<ul><li>every call to an AWS service is an API call.</ul><li>API keys for programmatic access (CLI).<ul><li>including the ability to <font color="red"> specify exactly which API calls the user is authorized to make to each service </font></ul></ul><li><strong>Shared access</strong><ul><li>grant other people permission to administer and use resources in the AWS account<li>without having to share your password or access key.</ul><li><strong>Secure access</strong> to AWS resources<ul><li>Integrated with may AWS services.<li>manage access to AWS services and resources securely.<li>Secure access to AWS resources for applications that run on EC2.<li>create and manage AWS users and groups.<ul><li>should use groups to assign permissions to IAM users<li>should <font color="red"> avoid embedding access keys in application code </font></ul></ul><li><strong>Temporary security credentials</strong><ul><li>IAM can assign temporary security credentials to provide users with temporary access to services/resources.<li>AWS access key ID, secret access key, and security token.</ul><li><strong>Multi-factor authentication (MFA)</strong><ul><li>Add two-factor authentication to the account and to individual users<li>extra security.<li>authentication device that generates random, six-digit, single-use authentication codes<li>authenticate using an MFA device in the following two ways:<ul><li><code class="language-plaintext highlighter-rouge">AWS Management Console</code>: user name, password and authentication code.<li><code class="language-plaintext highlighter-rouge">AWS API</code>: restrictions are added to IAM policies and developers can request temporary security credentials and pass MFA parameters in their AWS STS API requests.<li><code class="language-plaintext highlighter-rouge">AWS CLI</code>: obtaining temporary security credentials from STS (aws sts get-session-token).</ul></ul><li><strong>Identity federation</strong><ul><li>Identity Federation (including AD, Facebook etc.) can be configured<li>allow users who already have passwords elsewhere (corporate network) to get temporary access to the AWS account.<li>allowing secure access to resources in an AWS account <code class="language-plaintext highlighter-rouge">without creating an IAM user account</code>.<li>cannot use IAM to create local user accounts on any system.</ul><li><strong>Eventually consistent</strong></ul><blockquote><p>IAM is <font color="red"> not used for application-level authentication </font></p></blockquote><blockquote><p>IAM is <font color="red"> universal (global)</font> and does not apply to regions.</p></blockquote><ul><li><p>Identity information for assurance.</p><li><p>PCI DSS compliance.</p></ul><h3 id="to-use-aws-iam">to use AWS IAM</h3><ul><li>AWS Management Console.<li>AWS Command Line Tools.<li>AWS SDKs.<ul><li>recommend use AWS SDKs to make programmatic API calls to IAM.</ul><li>IAM HTTPS API.<li>can also use IAM Query API to make direct calls to the IAM web service.<li>sign-in URL:<ul><li><code class="language-plaintext highlighter-rouge">https://AWS_Account_ID.signin.aws.amazon.com/console/</code><li><code class="language-plaintext highlighter-rouge">https://console.aws.amazon.com/.</code></ul></ul><h2 id="essential-components">essential components</h2><ul><li><code class="language-plaintext highlighter-rouge">IAM user</code>:<ul><li>a <code class="language-plaintext highlighter-rouge">person/application</code> that is defined in an AWS account, and that must make API calls to AWS products.<li>Each user must have a unique name (no spaces in name) within the AWS account,<li>and a set of security credentials that are different from the AWS account root user security credentials.<li>Each user is defined in one and only one AWS account.</ul><li><code class="language-plaintext highlighter-rouge">IAM group</code>:<ul><li>a collection of users.<li>use groups to <code class="language-plaintext highlighter-rouge">simplify specifying and managing permissions for multiple users</code>.</ul><li><code class="language-plaintext highlighter-rouge">IAM policy</code>:<ul><li>a document that defines permissions to determine what users can do in the AWS account.<li>A policy typically <code class="language-plaintext highlighter-rouge">grants access to specific resources to user, or explicitly deny access</code>.</ul><li><code class="language-plaintext highlighter-rouge">IAM role</code>:<ul><li>a tool for granting temporary access to specific AWS resources in an AWS account.<li>only selected users or applications.<li>Aws service can access other service.</ul></ul><p>Use <code class="language-plaintext highlighter-rouge">IAM Policies</code> to control access to the following:</p><ul><li><code class="language-plaintext highlighter-rouge">AWS for Principals</code><ul><li>Control what the person making the request (theprincipal) is allowed to do.</ul><li><code class="language-plaintext highlighter-rouge">IAM Identities</code><ul><li>Control which <code class="language-plaintext highlighter-rouge">IAM identities (groups, users, and roles)</code> can be accessed and how.</ul><li><code class="language-plaintext highlighter-rouge">IAM Policies</code><ul><li>Control who can create, edit, and delete customer managed policies,<li>and who can attach and detach all managed policies.</ul><li><code class="language-plaintext highlighter-rouge">AWS Resources</code><ul><li>Control who has access to resources<li>using an <code class="language-plaintext highlighter-rouge">identity-based policy</code> or a <code class="language-plaintext highlighter-rouge">resource-based policy</code>.</ul><li><code class="language-plaintext highlighter-rouge">AWS Accounts</code><ul><li>Control whether a request is allowed only for members of a specific account.</ul></ul><p>￼<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/c8OIchz.png" alt="Screen Shot 2020-06-08 at 12.20.26" /></p><hr /><h2 id="the-iam-console">The IAM console</h2><ul><li>provides information about when IAM users and roles last attempted to access AWS services. This information is called <code class="language-plaintext highlighter-rouge">service last accessed data</code>.<ul><li>help you identify unnecessary permissions<li>to refine your IAM policies<li>to better adhere to the principle of “least privilege.”<li>granting the minimum permissions required to perform a specific task.</ul><li>You can find the data on the Access Advisor tab in the IAM console by examining the detail view for any IAM user, group, role, or managed policy.</ul><hr /><h2 id="iam-policy">IAM policy</h2><ul><li>By default<li> <font color="red"> the AWS account root user has full access </font><li> <font color="red"> default AWS account users do not have any permissions to any resources/data in AWS account </font><ul><li>default AWS account has no access to any services:<li>must <font color="blue"> explicitly grant permissions </font> to a user/group/role by <code class="language-plaintext highlighter-rouge">creating a policy</code><li>attaching an IAM access policy to IAM user/group</ul><li>When there is a conflict, the most restrictive policy applies.<ul><li> <font color="red"> allow vs deny: deny win </font></ul><li>All permissions are denied by default.<ul><li>The most restrictive policy is applied.<li>default <font color="blue"> implicit deny </font> of an IAM identity can <font color="red"> be overridden</font> with an <font color="blue"> explicit allow </font> ???</ul><li>a document in <code class="language-plaintext highlighter-rouge">JavaScript Object Notation (JSON)</code> format<ul><li>lists permissions that <code class="language-plaintext highlighter-rouge">allow / deny</code> access to resources in the AWS account.</ul><li><p>follow the principle of least privilege</p><li><code class="language-plaintext highlighter-rouge">the scope</code> of the service configurations <code class="language-plaintext highlighter-rouge">is global</code>.<ul><li>The settings are not defined at an AWS Region level.<li>settings apply across all AWS Regions.</ul><li>Resources are defined using the <code class="language-plaintext highlighter-rouge">ARN format</code><ul><li>the syntax for ARNs<li><code class="language-plaintext highlighter-rouge">arn:partition:service:region:account-id:</code></ul></ul><p>2 types of policy:</p><ul><li><strong>Identity-based policies</strong><li><strong>Resource-based policies</strong><li><strong>Service control policies (SCPs)</strong></ul><hr /><h3 id="inline-policies-vs-managed-policies-vs-custom-policies">Inline Policies vs Managed Policies vs Custom Policies</h3><p><strong>Managed policies</strong></p><ul><li>created and administered by AWS<ul><li>prebuild, Standalone identity-based policies<li>cannot change<li>AWS managed policies have automatic updates.<li>has overhead, more rigid out of the two.</ul><li>for common use cased based on job function:<ul><li><code class="language-plaintext highlighter-rouge">AmazonDynamoDBFullAccess</code>, <code class="language-plaintext highlighter-rouge">AWSCodeCOmmitPowerUser</code>, <code class="language-plaintext highlighter-rouge">AmazonEC2ReadOnlyAccess</code></ul><li>one policy can<ul><li>assign to multiple users/groups/roles<li>in <font color="red"> same/different AWS account </font></ul><li>A Managed Policy <code class="language-plaintext highlighter-rouge">applies policies</code> to a user, group, or role (without exceptions).</ul><p><strong>Customer managed policy</strong>:</p><ul><li>managed by you<li>Standalone policy user create<li>more flexible but requires administration.<li>policy can<ul><li>assign to multiple users/groups/roles<li>in <font color="red"> only your AWS account </font></ul></ul><p><strong>Inline policies</strong></p><ul><li>managed by you<li>embedded directly to a single user/group/role to which it aaplies.<ul><li>when user/group/role been deleted, the policy also be deleted</ul><li>policy can<ul><li>assign to one users/groups/roles<li> <font color="red"> strict 1:1 relationship between entity and the policy </font><li>in <font color="red"> only your AWS account </font></ul><li>usally Inline Policies are used <font color="blue"> to create exceptions </font> to a user, group, or role.<ul><li>when you want to be sure that the permissions is not been assigned to any other user.</ul></ul><blockquote><p>create in the user, add inline policy</p></blockquote><hr /><h3 id="identity-based-policies"><strong>Identity-based policies</strong></h3><ul><li>A policy that is attached to an identity in IAM<ul><li>less overhead to use a SCP for the entire AWS account.<li>permissions policies that attach to a principal/identity (user/role/group).</ul><li> <font color="red"> control what actions that identity can perform, on which resources, and under what conditions </font><li>Identity-based policies categorized:<ul><li><strong>Managed policies</strong><ul><li>prebuild, Standalone identity-based policies<li>can attach to multiple users/groups/roles in AWS account<li>A Managed Policy <code class="language-plaintext highlighter-rouge">applies policies</code> to a user, group, or role (without exceptions).<ul><li><strong>customer managed policy</strong>:<ul><li>more flexible but requires administration.</ul><li><strong>AWS managed policy</strong><ul><li>has overhead, more rigid out of the two.<li>AWS managed policies have automatic updates.</ul></ul></ul><li><strong>Inline policies</strong><ul><li>Policies embedded directly to a single user/group/role<li>Inline Policies are used to create exceptions to a user, group, or role.</ul></ul></ul><hr /><h3 id="resource-based-policies"><strong>Resource-based policies</strong></h3><ul><li><code class="language-plaintext highlighter-rouge">JSON policy documents that attach to a resource (S3 bucket...)</code>.<li><code class="language-plaintext highlighter-rouge">control what actions a specified principal can perform on that resource, and under what conditions</code>.<li><strong>inline only</strong>:<ul><li>define the policy on the resource itself, instead of creating a separate policy document that you attach.<li>For example<ul><li>create an S3 bucket policy (a type of resource-based policy) on an S3 bucket<li>-&gt; the bucket<li>-&gt; Permissions tab<li>-&gt; Bucket Policy button<li>-&gt; define the JSON-formatted policy document there.</ul></ul><li>An <code class="language-plaintext highlighter-rouge">Amazon S3 access control list (ACL)</code> is another example of a resource-based policy</ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/FW1kVeh.png" alt="HVBkIYM" /></p><blockquote><p>identity-based policy.</p><ul><li>An policy that grants access to the S3 bucket is attached to the MaryMajor user.</ul></blockquote><blockquote><p>resource-based policy.</p><ul><li>The S3 bucket policy for the <code class="language-plaintext highlighter-rouge">photos bucket</code> specifies that the user MaryMajor is allowed to list and read the objects in the bucket.<li>An explicit deny statement will always take precedence over any allow statement.<li>could define a deny statement in a bucket policy to restrict access to specific users, even if the users are granted access in a separate identity-based policy.</ul></blockquote><p>￼ <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/MtihYSq.png" alt="X79K6Ni" /></p><p>determines permissions <strong>explicit denial policy -&gt; explicit allow policy -&gt; deny</strong></p><hr /><h3 id="service-control-policies-scps"><strong>Service control policies (SCPs)</strong></h3><ul><li><p>one type of policy</p><li>use <font color="red"> to manage organization </font><ul><li>Attaching an SCP to an AWS Organizations entity (root, OU, or account)<li>defines a guardrail for what actions the principals can perform.</ul><li>enables <font color="red"> permission controls </font><ul><li>can <font color="blue"> limit account usage </font> to organizational units or linked accounts.<li>offer <font color="red"> central control </font> over the maximum available permissions <font color="blue"> for all accounts in organization </font><li>ensure accounts stay in organization’s access control guidelines.</ul><li>available only in an organization that <font color="red"> has all features enabled </font><ul><li>SCPs are not automatically enabled;<li>including consolidated billing<ul><li>SCPs aren’t available if organization has enabled only the consolidated billing feature</ul></ul><li> <font color="red"> restrict the root user of an Organization Unit account </font><ul><li>SCP is a way to restrict a root user on an account.<li>defines a safeguard for the actions that accounts in the organization root or OU can do.<li>Attaching an SCP to the organization root/unit (OU)<ul><li>Log in to the master account and create the SCP<li>Select the <font color="blue"> Organizational Unit </font><li> <font color="blue"> Enable the SCP </font><p>for the Organizational Unit</p><li>Attach the SCP to the member account within the Organizational Unit</ul></ul><li> <font color="red"> not a substitute for well-managed each account </font><ul><li>still need attach IAM policies to users/roles in organization’s accounts<li>to actually grant permissions to them.</ul><li>similar to IAM permissions policies<ul><li>almost the same syntax. JSON<li>but, SCP policies <font color="blue"> never grants permissions. </font><ul><li> <font color="red"> it the maximum permissions </font><p> for an organization or OU.</p></ul></ul><li> <font color="red"> No permissions are granted by an SCP </font><ul><li>it defines a guardrail, or sets limits, on the actions that the account’s administrator can delegate to the IAM users/roles in the affected accounts.<ul><li>The administrator must still attach <code class="language-plaintext highlighter-rouge">identity/resource-based policies</code> to IAM users/roles, or to the resources in accounts to actually grant permissions.</ul><li>The <font color="blue"> effective permissions </font><ul><li>the logical intersection between <strong>what is allowed by the SCP</strong> and <strong>what is allowed by the IAM/Resource-based policies</strong></ul><li>Important<ul><li>SCPs don’t affect users or roles in the management account.<li>affect only the member accounts in the organization.</ul></ul><li>by default <code class="language-plaintext highlighter-rouge">FullAWSAccess</code><ul><li>a service control policy<li>allows users to access services/resources on an attached account.<li>allows access to all AWS services within an attached member account</ul></ul><hr /><h2 id="iam-root-account">IAM root account</h2><p>The root account has full administrative permissions and these cannot be restricted.</p><ul><li>Best practice for root accounts:<ul><li>Don’t use the root user credentials.<li>Don’t share the root user credentials.<li>Create an IAM user and assign administrative permissions as required.<li>Enable MFA.</ul></ul><hr /><h2 id="iam-users">IAM users</h2><ul><li>maximum amount of IAM users per account: 5,000<li>IAM users can be created to represent applications and these are known as “service accounts”.<li>Each user account has a friendly name and an <font color="red"> ARN </font> which uniquely identifies the user across AWS.<ul><li>A unique ID is also created which is returned only when you create the user using the API, Tools for Windows PowerShell or the AWS CLI.</ul></ul><blockquote><p>You should create individual IAM accounts for users (best practice not to share accounts).</p></blockquote><p>authenticate: how the user is permitted to use to access AWS resources.</p><ul><li>2 types: <ul><li>programmatic access <li>AWS Management Console access.<li>only or both</ul><li><strong>programmatic access</strong>:<ul><li><code class="language-plaintext highlighter-rouge">access key ID</code> and a <code class="language-plaintext highlighter-rouge">secret access key</code><ul><li>cannot be used to login to the AWS console.<li>can only be used once and must be regenerated if lost.</ul><li>to make an <code class="language-plaintext highlighter-rouge">AWS API call</code> by <code class="language-plaintext highlighter-rouge">AWS CLI/SDK/other development tool</code>.</ul><li><strong>AWS Management Console access</strong><ul><li>browser login window.<ul><li>12-digit account ID / corresponding account alias.<li><code class="language-plaintext highlighter-rouge">user name and password</code></ul><li>If multi-factor authentication (MFA) is enabled: an authentication code.<ul><li>With MFA, users and systems must provide an <code class="language-plaintext highlighter-rouge">MFA token + the regular sign-in credentials</code>, before access AWS services and resources.<li><strong>for generating the MFA authentication token</strong>:<ul><li><code class="language-plaintext highlighter-rouge">virtual MFA-compliant applications</code>(Google Authenticator / Authy 2-Factor Authentication…),<li><code class="language-plaintext highlighter-rouge">U2F security key devices</code> (Yubikey)<li><code class="language-plaintext highlighter-rouge">hardware MFA devices</code> (Gemalto)</ul></ul></ul></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/Fbc0udg.png" alt="dwVKXzD" /></p><hr /><h2 id="iam-group">IAM group</h2><p>Important characteristics of groups:</p><ul><li>A group can contain many users<li>a user can belong to multiple groups.<li><strong>Groups cannot be nested</strong>.<ul><li>A group can contain only users,<li>a group cannot contain other groups.</ul><li>There is <code class="language-plaintext highlighter-rouge">no default group</code> that automatically includes all users in the AWS account.<li>group with all account users in it, you need to create the group and add each new user to it.<li>A group is not an identity and <code class="language-plaintext highlighter-rouge">cannot be identified as a principal in an IAM policy</code>.</ul><hr /><h2 id="iam-roles">IAM roles</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/W0u4eW2.png" alt="ilJwlvj" /></p><ul><li>an identity in account that has specific permissions.<li>is an AWS identity that can attach permissions policies<li>but instead of being uniquely associated with one person, a role is <code class="language-plaintext highlighter-rouge">intended to be assumable by anyone who needs it.</code><li><p>an IAM entity that defines a set of permissions for making AWS service requests.</p><li><p>Roles can be assumed temporarily through the console or programmatically with the AWS CLI, Tools for Windows PowerShell or API.</p><li>not using permanent credentials<ul><li><code class="language-plaintext highlighter-rouge">does not have standard long-term credentials</code> (password/access keys associated with it…)<li>assume a role, the role provides <code class="language-plaintext highlighter-rouge">temporary security credentials</code> for role session.<li>Temporary credentials are primarily used with IAM roles and automatically expire.<li>IAM users or AWS services can assume a role to obtain temporary security credentials that can be used to make AWS API calls.</ul><li>IAM roles are not associated with a specific user or group.<ul><li>Instead, trusted entities assume roles, such as IAM users, applications, or AWS services such as EC2.<li>delegate permissions to resources for users and services<li>IAM users can temporarily assume a role to take on permissions for a specific task.</ul><li>assign limitation<ul><li>A role can be assigned to a federated user who signs in using an external identity provider.<li>an IAM user in the same AWS account as the role or a user in a different AWS account.<li>but cannot apply multiple roles to a single instance.</ul><li>allowed to assume IAM Roles<ul><li><code class="language-plaintext highlighter-rouge">IAM Users</code><ul><li>When an IAM User is needing elevated permissions for a temporary task</ul><li><code class="language-plaintext highlighter-rouge">External accounts</code><ul><li>grant access to your account to third parties to perform an audit on your resources.<li>When a trusted remote account needs access to AWS resources</ul><li><code class="language-plaintext highlighter-rouge">AWS services/resources</code><ul><li>When an AWS service or resource needs access to other AWS service or resource</ul><li><code class="language-plaintext highlighter-rouge">Applications</code><ul><li>allow a mobile app to use AWS resources, but do not want to embed AWS keys within the app (difficult to rotate and can potentially extract).<li>When an external application needs access to an AWS resource like <code class="language-plaintext highlighter-rouge">DynamoDB</code></ul><li><strong>IAM Groups are not allowed to assume IAM Roles</strong>.</ul><li>use roles to <code class="language-plaintext highlighter-rouge">delegate 托付 access to users/app/services</code> that do not normally have access to your AWS resources.<ul><li>For example<li>grant users in the AWS account access to resources don’t usually have, or grant users in one AWS account access to resources in another account.<li>grant AWS access to users who already have identities that are defined outside of AWS, such as in your corporate directory.</ul><li>two types of policies in an IAM Role<ul><li>The <code class="language-plaintext highlighter-rouge">trust policy</code><ul><li>allows identities to assume roles</ul><li>the <code class="language-plaintext highlighter-rouge">permission policy</code><ul><li>defines the permissions provided.<li>A permissions policy must also be attached to the user in the trusted account.</ul></ul><li><p>Wildcards (<code class="language-plaintext highlighter-rouge">*</code>) cannot be specified as a principal.</p><li><p>For all of these example use cases, roles are an essential component to implementing the cloud deployment.</p><li>IAM roles with EC2 instances:<ul><li>IAM roles can be used for granting applications running on EC2 instances permissions to AWS API requests using instance profiles.<li>Only one role can be assigned to an EC2 instance at a time.<li>A role can be assigned at the EC2 instance creation time or at any time afterwards.<li>When using the AWS CLI or API instance profiles must be created manually (it’s automatic and transparent through the console).<li>Applications retrieve temporary security credentials from the instance metadata.</ul></ul><hr /><h2 id="aws-organizations">AWS Organizations</h2><ul><li>With AWS Organizations, <strong>Consolidated Billing</strong> is always enabled.<ul><li>All other features are either enabled / disabled as a group<li>cannot individually enable or disable a feature - it’s all or nothing</ul></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/01aws/'>01AWS</a>, <a href='/categories/idenaccessmanage/'>IdenAccessManage</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >AWS</a> <a href="/tags/idenaccessmanage/" class="post-tag no-text-decoration" >IdenAccessManage</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=AWS - IdenAccessManage - IAM (Identity and Access Management) - Grace&url=https://ocholuo.github.io//posts/IAM/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=AWS - IdenAccessManage - IAM (Identity and Access Management) - Grace&u=https://ocholuo.github.io//posts/IAM/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=AWS - IdenAccessManage - IAM (Identity and Access Management) - Grace&url=https://ocholuo.github.io//posts/IAM/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://ocholuo.github.io//posts/IAM/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CI-CD/">CI/CD - Continuous Integration & Continous Delivery</a><li><a href="/posts/Github-Action-example/">CI/CD - Github Action Template</a><li><a href="/posts/CloudMap/">AWS - EKS - Cloud Map</a><li><a href="/posts/DataWrangler/">AWS - ML - Data Wrangler</a><li><a href="/posts/0CodePipeline/">AWS - CodeDevelop - CodePipeline</a><li><a href="/posts/1CodeCommit/">AWS - CodeDevelop - CodeCommit</a><li><a href="/posts/2CodeBuild/">AWS - CodeDevelop - CodeBuild</a><li><a href="/posts/2CodeBuildTemplate-buildspec/">AWS - CodeDevelop - CodeBuild - buildspec.yml Template</a><li><a href="/posts/ElasticBeanstalk/">AWS - CodeDevelop - ElasticBeanstalk</a><li><a href="/posts/CourseREADME/">Course - Learning Path</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/soc/">SOC</a> <a class="post-tag" href="/tags/network/">Network</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Amazon-Cognito/"><div class="card-body"> <span class="timeago small" > Jul 18, 2020 <i class="unloaded">2020-07-18T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS - IdenAccessManage - Amazon Cognito</h3><div class="text-muted small"><p> [toc] Amazon Cognito web identity federation allows user to authenticate with a web identity ptovider (google, facebook) ther user authenticates first with the web id provider and rece...</p></div></div></a></div><div class="card"> <a href="/posts/AWS-organizations/"><div class="card-body"> <span class="timeago small" > Jul 18, 2020 <i class="unloaded">2020-07-18T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS - IdenAccessManage - AWS Organizations and SCP</h3><div class="text-muted small"><p> [toc] AWS Organizations an account management service. ￼ AWS Organizations enables you to: policy-based account management: Create  service control policies (SCPs)  that ce...</p></div></div></a></div><div class="card"> <a href="/posts/IAM-Service/"><div class="card-body"> <span class="timeago small" > Jul 18, 2020 <i class="unloaded">2020-07-18T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS - IdenAccessManage - AWS services that work with IAM</h3><div class="text-muted small"><p> [toc] AWS services that work with IAM The AWS services listed below are grouped by their AWS product categories and include information about what IAM features they support: Service ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/IAM-User-Login/" class="btn btn-outline-primary" prompt="Older"><p>AWS - IdenAccessManage - IAM User Login</p></a> <a href="/posts/STS/" class="btn btn-outline-primary" prompt="Newer"><p>AWS - IdenAccessManage - STS Security Token Service</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//https-ocholuo-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'AWS - IdenAccessManage - IAM (Identity and Access Management)'; this.page.url = 'https://ocholuo.github.io//posts/IAM/'; this.page.identifier = '/posts/IAM/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/soc/">SOC</a> <a class="post-tag" href="/tags/network/">Network</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
